<body>
<div class="row" style="background-color:rgb(248, 246, 246); margin: 5rem; padding:5rem ;">
    <div class="col-md-6 m-auto">
      <div class="container pl-5">
        <h3 class="text-center">CREATE NEW ADMIN</h3>
        <form id="form">
          <div class="form-group">
           
            <input type="text" class="form-control mb-2" name="username" placeholder="Enter username"/></div>
            <div class="usernameError" style="color: red;"></div>
            <div class="form-group">
            
            <input type="password" class="form-control mb-2" name="password" placeholder="Password"/></div>
            <div class="passwordError" style="color: red;"></div>
          <button type="submit" class="btn btn-primary float-end mt-1">Signup</button>
        </form>
      </div>
      <p><a style="color: rgb(146, 96, 4);" href="/adminLogin">Already have an account !</a></p>
    </div>
  </div>

  <script>
   
    const form = document.querySelector("#form");
    const usernameError = document.querySelector('.usernameError');
    const passwordError = document.querySelector('.passwordError');

    form.addEventListener('submit',async(e)=>{
        e.preventDefault();
        console.log('signup submit');

        // // reset errors
        usernameError.textContent='';
        passwordError.textContent='';

        //get the values
        const username = form.username.value;
        const password = form.password.value;

        console.log(username,password);

        try{
            const res = await fetch('/adminSignup',{
                method : 'POST',
                body:JSON.stringify({username,password}),
                headers:{'Content-Type': 'application/json'}
        }); 
        const data = await res.json();

        console.log(data.errorHandler);

        if(data.errorHandler){
            usernameError.textContent=data.errorHandler.username;
            passwordError.textContent=data.errorHandler.password;
        }
        if(data.admin){
          console.log(data.admin); 
          location.assign('/adminLogin');  
        }
    }
    catch(err){
        console.log(err);
    }
    })
</script>
</body>